# md5_fix_point

MD5 是否有不动点尚无定论，这是一个很有趣的问题。

### 1 字符串 MD5 不动点存在性讨论

MD5 作为一种信息摘要，根据目前已知的统计，md5 输出中每个数的出现符合均匀分布（这只是一个不严格的假设，实际上 MD5 的输出并非严格均匀），在密码学上可以将其视作随机数。

对于任意输入`x*`，其输出`MD5(x*)`都是 128bit，即 $\forall x, MD5(x) \in \{0, 1\} ^{128}$。

那么这个问题可以描述为，寻找 $\exists x \in \{0, 1\} ^{128} \Rightarrow MD5(x) = x$。

综上所述，对于任意输入 x，其满足条件的概率为 $\frac{1}{2^{128}}$；那么对于任意输入 x，其满足条件的概率为 $1 - \frac{1}{2^{128}}$；对于所有的输入跑，都不满足条件的概率为 $(1 - \frac{1}{t}) ^ t$，其中 $t = 2^{128}$。

考虑到 $\lim _{t \to \infty} (1 - \frac{1}{t}) ^t = \frac{1}{e}$，并且 $t = 2^{128} \approx 3.4 \times 10 ^{38}$，是一个比较大的数，那么可以简单计算，MD5 不动点存在的概率为：

$$
1 - \lim _{t \to \infty} (1 - \frac{1}{t}) ^t \\ 
= 1 - \frac{1}{e} \\ \approx 63.2 \%
$$



### 2 解决方法讨论

这个问题的寻找方式似乎没有多项式解法。

MD5 对应的字符串是16个（128bits）字符，满足条件的输入字符串也必然是 16 位的字符串，且由数字`0~9`，字符`a~f`构成。那么的 MD5 字符串的必然是有限的。

根据前面的存在性讨论，字符串 MD5 不动点的存在概率不等于 1，如果没有办法找到不动点，找到前 N 或后 N 个字符串是相同的也是很有趣的。


#### 2.1 暴力枚举

暴力枚举，是最容易想到的方法。MD5 对应的字符串是16个（128bits）字符，满足条件的输入字符串也必然是 16 位的字符串，且由数字`0~9`，字符`a~f`构成。那么可以由此遍历每一个符合条件的长度为 16 的字符串并计算其 MD5 值，记录字符串 MD5 前 N 位与输入字符相同的结果。

暴力枚举需要验证的字符串数目为 $2^{128}$ 个，数量级在 $10^{38}$ 左右。




#### 2.2 寻找周期轨

从某一个 16 位字符串开始，计算字符串的 MD5，之后将前一次的输出作为当前计算的输入，直到某个输入在之前出现过，那么就找到了一个 md5 环。

更进一步的，当这个环的长度为 1 的时候，这个输入字符串就是 MD5 的不动点。



reference：

[是否存在一个字符串，它的md5值是其自身？](https://www.zhihu.com/question/21533582/answer/33746266)
